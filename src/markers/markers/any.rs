use crate::markers::markers::{parser::MarkerComponents, tag::TAG_MAP};

use super::all::*;
use enum_dispatch::enum_dispatch;

#[enum_dispatch]
#[derive(Clone, Debug, PartialEq, Eq, PartialOrd, Ord)]
pub enum AnyMarker {
    ADD,
    ADDPN,
    B,
    PoetryB,
    BD,
    BDIT,
    BK,
    C,
    CA,
    CD,
    CL,
    CLS,
    CP,
    D,
    DC,
    DoubleForwardSlash,
    EM,
    F,
    FDC,
    FE,
    FIG,
    FK,
    FL,
    FM,
    FP,
    FQ,
    FQA,
    FR,
    FT,
    FV,
    FW,
    H,
    IB,
    ID,
    IDE,
    IE,
    IEX,
    ILI,
    IM,
    IMI,
    IMQ,
    IMT,
    IMTE,
    IO,
    IOR,
    IOT,
    IP,
    IPI,
    IPQ,
    IPR,
    IQ,
    IQT,
    IS,
    IT,
    K,
    LF,
    LH,
    LI,
    LIK,
    LIM,
    LIT,
    LITL,
    LIV,
    M,
    MI,
    MR,
    MS,
    MT,
    MTE,
    NB,
    ND,
    NDX,
    NO,
    ORD,
    P,
    PB,
    PC,
    PH,
    PI,
    PM,
    PMC,
    PMO,
    PMR,
    PN,
    PNG,
    PO,
    PR,
    PRO,
    Q,
    QA,
    QAC,
    QC,
    QD,
    QM,
    QR,
    QS,
    QT,
    R,
    RB,
    REM,
    RQ,
    HeadingRQ,
    S,
    SC,
    SD,
    SIG,
    SLS,
    SP,
    SR,
    STS,
    SUP,
    TC,
    TCR,
    TH,
    THR,
    TL,
    TOC,
    TOCA,
    TR,
    Tilde,
    USFM,
    V,
    VA,
    VP,
    W,
    WA,
    WG,
    WH,
    WJ,
    X,
    XDC,
    XK,
    XNT,
    XO,
    XOP,
    XOT,
    XQ,
    XT,
    XTA,
}

impl AnyMarker {
    pub fn new(component: MarkerComponents) -> Result<Self, String> {
        Ok(match TAG_MAP.get(component.marker()) {
            Some(func) => func(component.parameters()),
            None => Err(component.marker())?,
        })
    }
}
